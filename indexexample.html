<!DOCTYPE html>
<html>

<head>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <title>D3 Project</title>
</head>

<body>
    <div class="main">
        <header>
            <h1>Dashboard</h1>
        </header>


        <!-- We will add the donut and table here -->
        <h2>Total answers</h2>
        <div class="row">
            <div id="counter_table"></div>
            <div id="today"></div>
        </div>

        <!-- We will add barchart here -->
        <h2>Rates</h2>
        <div class="row">
            <div id="rates">
            </div>
        </div>

        <!-- We will add the data table here -->
        <h2>DATA</h2>
        <div class="row">
            <div id="table">
            </div>
        </div>

    </div>
    <footer>
        <p>D3 PRoject Copyright &copy, 2018</p>
    </footer>



    <script>
        var data = [
            { name: "Ana", rate: 9, comment: "Very intensive but challenging. I love it" },
            { name: "Mike", rate: 5, comment: "It is too hard for me and I struggle understand the lessons" },
            { name: "Jacob", rate: 10, comment: "I love the academy! I learn so many things!" },
            { name: "Sil", rate: 7, comment: "It is cool I expected more challenges" },
            { name: "Vanya", rate: 8, comment: "The lessons are very organized and itâ€™s easy to keep up." },
            { name: "David", rate: 3, comment: "I couldn t understand anything from the first day. I would like more lessons than working by myself" },
            { name: "Karel", rate: 10, comment: "Best academy ever! So challenging and exciting" },
            { name: "Jiri", rate: 9, comment: "I love the teachers and the challenges." },
            { name: "Kate", rate: 9, comment: "I am satisfied with the level  intensity." },
            { name: "Jane", rate: 9, comment: "It is exactly what I expected a great academy" },
        ];
// NEW DATA 
        let newData = "";
        let rate0 = 0;
        let rate1 = 0;
        let rate2 = 0;
        let rate3 = 0;
        let rate4 = 0;
        let rate5 = 0;
        let rate6 = 0;
        let rate7 = 0;
        let rate8 = 0;
        let rate9 = 0;
        let rate10 = 0;


        for (let i = 0; i < data.length; i++) {

            if (data[i].rate === 0) {
                rate0++;
            }
            if (data[i].rate === 1) {
                rate1++;
            }
            if (data[i].rate === 2) {
                rate2++;
            }
            if (data[i].rate === 3) {
                rate3++;
            }
            if (data[i].rate === 4) {
                rate4++;
            }
            if (data[i].rate === 5) {
                rate5++;
            }
            if (data[i].rate === 6) {
                rate6++;
            }
            if (data[i].rate === 7) {
                rate7++;
            }
            if (data[i].rate === 8) {
                rate8++;
            }
            if (data[i].rate === 9) rate9++;
            if (data[i].rate === 10) {
                rate10++;
            }
        }

        newData = [
            { zero: rate0 },
            { one: rate1 },
            { two: rate2 },
            { three: rate3 },
            { four: rate4 },
            { five: rate5 },
            { six: rate6 },
            { seven: rate7 },
            { eight: rate8 },
            { nine: rate9 },
            { ten: rate10 }

        ]


// THE END OF NEW DATA










        data.forEach(function (d) {
            d.rate = +d.rate;
        });
        var table = d3.select('#table').append('table');
        var tbody = table.append('tbody');
        var tr = tbody.selectAll('tr')
            .data(data).enter()
            .append('tr')
        tr.append('td').html(function (d) { return d.name; });
        tr.append('td').html(function (d) { return d.rate });
        tr.append('td').html(function (d) { return d.comment });

        var thead = table.append('thead').append('tr')
        thead.append('th').text("name");
        thead.append('th').text("comment");
        thead.append('th').attr("class", "rate").text("rate");



        // GRAPH 
        var rates_margin = { top: 20, right: 20, bottom: 70, left: 40 },
            rates_width = 900 - rates_margin.left - rates_margin.right,
            rates_height = 300 - rates_margin.top - rates_margin.bottom;

        var svg = d3.select("#rates").append("svg")
            .attr("width", rates_width + rates_margin.left + rates_margin.right)
            .attr("height", rates_height + rates_margin.top + rates_margin.bottom)
            .append("g")
            .attr("transform",
                "translate(" + rates_margin.left + "," + rates_margin.top + ")");

        var x = d3.scaleTime()
            .range([0, rates_width])
            .domain([data[0].name, data[data.length - 1].name]);

        var y = d3.scaleLinear()
            .range([rates_height, 0])
            .domain([0, d3.max(data, function (d) { return d.rate; })]);


        svg.selectAll("rect")
            .data(data)
            .enter().append("rect")
            .style("fill", "#267E83")
            .attr("x", function (d) { return x(d.name); })
            .attr("width", 50)
            .attr("y", function (d) { return y(d.rate); })
            .attr("height", function (d) { return rates_height - y(d.rate); });


        var yAxis = d3.axisLeft()
            .scale(y)
            .tickSize(-rates_width) //as wide as our graph
            .ticks(3);
        svg.append("g")
            .attr("class", "y axis")
            .call(yAxis)

        var xAxis = d3.axisBottom()
            .scale(x)
            .tickFormat(d3.timeFormat("%Y-%m"));


        svg.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + rates_height + ")")
            .call(xAxis)

        svg.selectAll("label")
            .data(data)
            .enter()
            .append("text")
            .attr("class", "label")
            .style("fill", "#019875")
            .attr("y", function (d) { return y(d.rate); })
            .attr("x", function (d) { return x(d.name); })
            .attr("dy", "-.35em") //vertical align middle
            .attr("dx", ".7em") //vertical align middle
            .text(function (d) { return d.rate; });






    </script>

</body>

</html>